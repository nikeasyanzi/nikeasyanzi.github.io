<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Visualized Monitoring With Prometheus and Grafana | Craig Yang's Dev Blog</title><meta name=keywords content="Observibility"><meta name=description content='Introduction
In this article, we demonstrate

how to use Prometheus to collect and monitor our host machine and Nginx service.
Visualization presentation of the collected metrics in Grafana

Components

Prometheus collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels.
Prometheus node exporter exposes a wide variety of hardware- and kernel-related metrics.
Grafana ä¸€ç¨®åœ–å½¢åŒ–è™•ç†è»Ÿé«”ï¼Œå¯æ”¯æ´ä¸åŒå‹å¼çš„ä¾†æºè³‡æ–™æ•¸æ“šï¼Œä¸¦ä»¥è±å¯Œçš„åœ–å½¢ä¾†å‘ˆç¾ç›¸é—œæ•¸æ“š

Configuration
Update docker-compose


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61


services:
  nginx:
    image: nginx:latest
    container_name: nginx
    volumes:
      - ./nginx/:/etc/nginx/conf.d
    ports:
      - 8082:8080

  nginx-prometheus-exporter:
    image: nginx/nginx-prometheus-exporter:1.4
    container_name: nginx-prometheus-exporter
    command: -nginx.scrape-uri http://nginx:8080/stub_status
    ports:
      - 9113:9113
    depends_on:
      - nginx

  # System monitoring
  node-exporter:
    container_name: node-exporter
    image: prom/node-exporter
    ports:
      - 9100:9100

  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus.yaml:/etc/prometheus/prometheus.yaml
      - ./prometheus_data:/prometheus
    command:
      - "--config.file=/etc/prometheus/prometheus.yaml"
    ports:
      - "9090:9090"
    depends_on:
      - node-exporter
      - nginx-prometheus-exporter

  #handles rendering panels & dashboards to PNGs
  renderer:
    image: grafana/grafana-image-renderer:3.4.2
    environment:
      BROWSER_TZ: Asia/Taipei
    ports:
      - "8081:8081"

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    volumes:
      - ./grafana_data:/var/lib/grafana
    environment:
      GF_SECURITY_ADMIN_PASSWORD: pass
      GF_RENDERING_SERVER_URL: http://renderer:8081/render
      GF_RENDERING_CALLBACK_URL: http://grafana:3000/
      GF_LOG_FILTERS: rendering:debug
    depends_on:
      - prometheus
    ports:
      - "3000:3000"


Update prometheus.yaml
Configure Prometheus scrap interval'><meta name=author content="4rkal"><link rel=canonical href=https://nikeasyanzi.github.io/posts/visualized-monitoring-with-prometheus-grafana/><link crossorigin=anonymous href=/assets/css/stylesheet.min.24117e94f7185554bf370e131546657a05d72834bf02c67c2a4215d5cf110a80.css integrity="sha256-JBF+lPcYVVS/Nw4TFUZlegXXKDS/AsZ8KkIV1c8RCoA=" rel="preload stylesheet" as=style><link rel=icon href=https://nikeasyanzi.github.io/4rkal.png><link rel=apple-touch-icon href=https://nikeasyanzi.github.io/apple-touch-icon.png><link rel=alternate hreflang=en href=https://nikeasyanzi.github.io/posts/visualized-monitoring-with-prometheus-grafana/><meta name=twitter:card content="summary"><meta name=twitter:title content="Visualized Monitoring With Prometheus and Grafana | Craig Yang's Dev Blog"><meta name=twitter:description content='Introduction
In this article, we demonstrate

how to use Prometheus to collect and monitor our host machine and Nginx service.
Visualization presentation of the collected metrics in Grafana

Components

Prometheus collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels.
Prometheus node exporter exposes a wide variety of hardware- and kernel-related metrics.
Grafana ä¸€ç¨®åœ–å½¢åŒ–è™•ç†è»Ÿé«”ï¼Œå¯æ”¯æ´ä¸åŒå‹å¼çš„ä¾†æºè³‡æ–™æ•¸æ“šï¼Œä¸¦ä»¥è±å¯Œçš„åœ–å½¢ä¾†å‘ˆç¾ç›¸é—œæ•¸æ“š

Configuration
Update docker-compose


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61


services:
  nginx:
    image: nginx:latest
    container_name: nginx
    volumes:
      - ./nginx/:/etc/nginx/conf.d
    ports:
      - 8082:8080

  nginx-prometheus-exporter:
    image: nginx/nginx-prometheus-exporter:1.4
    container_name: nginx-prometheus-exporter
    command: -nginx.scrape-uri http://nginx:8080/stub_status
    ports:
      - 9113:9113
    depends_on:
      - nginx

  # System monitoring
  node-exporter:
    container_name: node-exporter
    image: prom/node-exporter
    ports:
      - 9100:9100

  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus.yaml:/etc/prometheus/prometheus.yaml
      - ./prometheus_data:/prometheus
    command:
      - "--config.file=/etc/prometheus/prometheus.yaml"
    ports:
      - "9090:9090"
    depends_on:
      - node-exporter
      - nginx-prometheus-exporter

  #handles rendering panels & dashboards to PNGs
  renderer:
    image: grafana/grafana-image-renderer:3.4.2
    environment:
      BROWSER_TZ: Asia/Taipei
    ports:
      - "8081:8081"

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    volumes:
      - ./grafana_data:/var/lib/grafana
    environment:
      GF_SECURITY_ADMIN_PASSWORD: pass
      GF_RENDERING_SERVER_URL: http://renderer:8081/render
      GF_RENDERING_CALLBACK_URL: http://grafana:3000/
      GF_LOG_FILTERS: rendering:debug
    depends_on:
      - prometheus
    ports:
      - "3000:3000"


Update prometheus.yaml
Configure Prometheus scrap interval'><meta property="og:title" content="Visualized Monitoring With Prometheus and Grafana | Craig Yang's Dev Blog"><meta property="og:description" content='Introduction
In this article, we demonstrate

how to use Prometheus to collect and monitor our host machine and Nginx service.
Visualization presentation of the collected metrics in Grafana

Components

Prometheus collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels.
Prometheus node exporter exposes a wide variety of hardware- and kernel-related metrics.
Grafana ä¸€ç¨®åœ–å½¢åŒ–è™•ç†è»Ÿé«”ï¼Œå¯æ”¯æ´ä¸åŒå‹å¼çš„ä¾†æºè³‡æ–™æ•¸æ“šï¼Œä¸¦ä»¥è±å¯Œçš„åœ–å½¢ä¾†å‘ˆç¾ç›¸é—œæ•¸æ“š

Configuration
Update docker-compose


 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61


services:
  nginx:
    image: nginx:latest
    container_name: nginx
    volumes:
      - ./nginx/:/etc/nginx/conf.d
    ports:
      - 8082:8080

  nginx-prometheus-exporter:
    image: nginx/nginx-prometheus-exporter:1.4
    container_name: nginx-prometheus-exporter
    command: -nginx.scrape-uri http://nginx:8080/stub_status
    ports:
      - 9113:9113
    depends_on:
      - nginx

  # System monitoring
  node-exporter:
    container_name: node-exporter
    image: prom/node-exporter
    ports:
      - 9100:9100

  prometheus:
    image: prom/prometheus:latest
    container_name: prometheus
    volumes:
      - ./prometheus.yaml:/etc/prometheus/prometheus.yaml
      - ./prometheus_data:/prometheus
    command:
      - "--config.file=/etc/prometheus/prometheus.yaml"
    ports:
      - "9090:9090"
    depends_on:
      - node-exporter
      - nginx-prometheus-exporter

  #handles rendering panels & dashboards to PNGs
  renderer:
    image: grafana/grafana-image-renderer:3.4.2
    environment:
      BROWSER_TZ: Asia/Taipei
    ports:
      - "8081:8081"

  grafana:
    image: grafana/grafana:latest
    container_name: grafana
    volumes:
      - ./grafana_data:/var/lib/grafana
    environment:
      GF_SECURITY_ADMIN_PASSWORD: pass
      GF_RENDERING_SERVER_URL: http://renderer:8081/render
      GF_RENDERING_CALLBACK_URL: http://grafana:3000/
      GF_LOG_FILTERS: rendering:debug
    depends_on:
      - prometheus
    ports:
      - "3000:3000"


Update prometheus.yaml
Configure Prometheus scrap interval'><meta property="og:type" content="article"><meta property="og:url" content="https://nikeasyanzi.github.io/posts/visualized-monitoring-with-prometheus-grafana/"><meta property="og:image" content="https://nikeasyanzi.github.io/4rkal.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-09-05T16:43:38+08:00"><meta property="article:modified_time" content="2025-09-05T16:43:38+08:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nikeasyanzi.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Visualized Monitoring With Prometheus and Grafana","item":"https://nikeasyanzi.github.io/posts/visualized-monitoring-with-prometheus-grafana/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Visualized Monitoring With Prometheus and Grafana | Craig Yang's Dev Blog","name":"Visualized Monitoring With Prometheus and Grafana","description":"Introduction In this article, we demonstrate\nhow to use Prometheus to collect and monitor our host machine and Nginx service. Visualization presentation of the collected metrics in Grafana Components Prometheus collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels. Prometheus node exporter exposes a wide variety of hardware- and kernel-related metrics. Grafana ä¸€ç¨®åœ–å½¢åŒ–è™•ç†è»Ÿé«”ï¼Œå¯æ”¯æ´ä¸åŒå‹å¼çš„ä¾†æºè³‡æ–™æ•¸æ“šï¼Œä¸¦ä»¥è±å¯Œçš„åœ–å½¢ä¾†å‘ˆç¾ç›¸é—œæ•¸æ“š Configuration Update docker-compose 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 services: nginx: image: nginx:latest container_name: nginx volumes: - ./nginx/:/etc/nginx/conf.d ports: - 8082:8080 nginx-prometheus-exporter: image: nginx/nginx-prometheus-exporter:1.4 container_name: nginx-prometheus-exporter command: -nginx.scrape-uri http://nginx:8080/stub_status ports: - 9113:9113 depends_on: - nginx # System monitoring node-exporter: container_name: node-exporter image: prom/node-exporter ports: - 9100:9100 prometheus: image: prom/prometheus:latest container_name: prometheus volumes: - ./prometheus.yaml:/etc/prometheus/prometheus.yaml - ./prometheus_data:/prometheus command: - \u0026#34;--config.file=/etc/prometheus/prometheus.yaml\u0026#34; ports: - \u0026#34;9090:9090\u0026#34; depends_on: - node-exporter - nginx-prometheus-exporter #handles rendering panels \u0026amp; dashboards to PNGs renderer: image: grafana/grafana-image-renderer:3.4.2 environment: BROWSER_TZ: Asia/Taipei ports: - \u0026#34;8081:8081\u0026#34; grafana: image: grafana/grafana:latest container_name: grafana volumes: - ./grafana_data:/var/lib/grafana environment: GF_SECURITY_ADMIN_PASSWORD: pass GF_RENDERING_SERVER_URL: http://renderer:8081/render GF_RENDERING_CALLBACK_URL: http://grafana:3000/ GF_LOG_FILTERS: rendering:debug depends_on: - prometheus ports: - \u0026#34;3000:3000\u0026#34; Update prometheus.yaml Configure Prometheus scrap interval\n","keywords":["Observibility"],"wordCount":"824","inLanguage":"en","datePublished":"2025-09-05T16:43:38+08:00","dateModified":"2025-09-05T16:43:38+08:00","author":{"@type":"Person","name":"4rkal"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nikeasyanzi.github.io/posts/visualized-monitoring-with-prometheus-grafana/"},"publisher":{"@type":"Organization","name":"Craig Yang's Dev Blog","logo":{"@type":"ImageObject","url":"https://nikeasyanzi.github.io/4rkal.png"}}}</script><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript></head><body class="dark type-posts kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="dark",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://nikeasyanzi.github.io/ accesskey=h title="Craig Yang's Dev Blog (Alt + H)">Craig Yang's Dev Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)">
<svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://nikeasyanzi.github.io/posts/ title=Posts class=active>ğŸ“š Posts</a></li><li><a href=https://nikeasyanzi.github.io/search/ title="Search the site (Alt + /)" data-no-instant accesskey=/>ğŸ” Search</a></li><li><a href=https://nikeasyanzi.github.io/archives/ title="ğŸ—‚ï¸ archives">ğŸ—‚ï¸ archives</a></li><li><a href=https://nikeasyanzi.github.io/about/ title=About>ğŸ˜ About</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://nikeasyanzi.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://nikeasyanzi.github.io/posts/>Posts</a></div><h1 class=post-title>Visualized Monitoring With Prometheus and Grafana</h1><div class=post-meta><span class=meta-item><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg>
<span>2025-09-05</span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://nikeasyanzi.github.io/tags/observibility/>Observibility</a></span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text" style="user-select:text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z" style="user-select:text"/><polyline points="14 2 14 8 20 8" style="user-select:text"/><line x1="16" y1="13" x2="8" y2="13" style="user-select:text"/><line x1="16" y1="17" x2="8" y2="17" style="user-select:text"/><polyline points="10 9 9 9 8 9" style="user-select:text"/></svg>
<span>824 words</span></span><span class=meta-item>
<svg width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>2 min</span></span></div></header><div class="toc side right"><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#components aria-label=Components>Components</a></li><li><a href=#configuration aria-label=Configuration>Configuration</a><ul><li><a href=#update-docker-compose aria-label="Update docker-compose">Update docker-compose</a></li><li><a href=#update-prometheusyaml aria-label="Update prometheus.yaml">Update prometheus.yaml</a></li></ul></li><li><a href=#start-services aria-label="Start services">Start services</a></li><li><a href=#service-check-and-troubleshooting aria-label="Service check and troubleshooting">Service check and troubleshooting</a></li><li><a href=#visualization-output aria-label="Visualization output">Visualization output</a><ul><ul><li><a href=#dashboard-for-host aria-label="Dashboard for Host">Dashboard for Host</a></li><li><a href=#dashboard-for-nginx aria-label="Dashboard for Nginx">Dashboard for Nginx</a></li></ul></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li><li><a href=#reference aria-label=Reference>Reference</a></li></ul></div></details></div><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>Â¶</a></h1><p>In this article, we demonstrate</p><ol><li>how to use Prometheus to collect and monitor our host machine and Nginx service.</li><li>Visualization presentation of the collected metrics in Grafana</li></ol><h1 id=components>Components<a hidden class=anchor aria-hidden=true href=#components>Â¶</a></h1><ul><li><strong>Prometheus</strong> collects and stores its metrics as time series data, i.e. metrics information is stored with the timestamp at which it was recorded, alongside optional key-value pairs called labels.</li><li><strong>Prometheus node exporter</strong> exposes a wide variety of hardware- and kernel-related metrics.</li><li><strong>Grafana</strong> ä¸€ç¨®åœ–å½¢åŒ–è™•ç†è»Ÿé«”ï¼Œå¯æ”¯æ´ä¸åŒå‹å¼çš„ä¾†æºè³‡æ–™æ•¸æ“šï¼Œä¸¦ä»¥è±å¯Œçš„åœ–å½¢ä¾†å‘ˆç¾ç›¸é—œæ•¸æ“š</li></ul><h1 id=configuration>Configuration<a hidden class=anchor aria-hidden=true href=#configuration>Â¶</a></h1><h2 id=update-docker-compose>Update docker-compose<a hidden class=anchor aria-hidden=true href=#update-docker-compose>Â¶</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nginx</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./nginx/:/etc/nginx/conf.d</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>8082</span><span class=p>:</span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nginx-prometheus-exporter</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx/nginx-prometheus-exporter:1.4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-prometheus-exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span>-<span class=l>nginx.scrape-uri http://nginx:8080/stub_status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>9113</span><span class=p>:</span><span class=m>9113</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># System monitoring</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>node-exporter</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>node-exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>prom/node-exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>9100</span><span class=p>:</span><span class=m>9100</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>prom/prometheus:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./prometheus.yaml:/etc/prometheus/prometheus.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./prometheus_data:/prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;--config.file=/etc/prometheus/prometheus.yaml&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;9090:9090&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>node-exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>nginx-prometheus-exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>#handles rendering panels &amp; dashboards to PNGs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>renderer</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>grafana/grafana-image-renderer:3.4.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>BROWSER_TZ</span><span class=p>:</span><span class=w> </span><span class=l>Asia/Taipei</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;8081:8081&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>grafana</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>grafana/grafana:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>grafana</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>./grafana_data:/var/lib/grafana</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GF_SECURITY_ADMIN_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>pass</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GF_RENDERING_SERVER_URL</span><span class=p>:</span><span class=w> </span><span class=l>http://renderer:8081/render</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GF_RENDERING_CALLBACK_URL</span><span class=p>:</span><span class=w> </span><span class=l>http://grafana:3000/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>GF_LOG_FILTERS</span><span class=p>:</span><span class=w> </span><span class=l>rendering:debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;3000:3000&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=update-prometheusyaml>Update prometheus.yaml<a hidden class=anchor aria-hidden=true href=#update-prometheusyaml>Â¶</a></h2><p>Configure Prometheus scrap interval</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>global</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>5s</span><span class=w> </span><span class=c># Server æŠ“å–é »ç‡</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>external_labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>monitor</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;my-monitor&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;prometheus&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;localhost:9090&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;node_exporter&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;node-exporter:9100&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;nginx_exporter&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;nginx-prometheus-exporter:9113&#34;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h1 id=start-services>Start services<a hidden class=anchor aria-hidden=true href=#start-services>Â¶</a></h1><p>Now, we use docker-compose to start our services.</p><ol><li>Run docker-compose.yaml</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker-compose -f ./docker-compose.yaml up -d
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>Check service status
<img loading=lazy src=https://i.imgur.com/CeS2yAn.png alt></li></ol><h1 id=service-check-and-troubleshooting>Service check and troubleshooting<a hidden class=anchor aria-hidden=true href=#service-check-and-troubleshooting>Â¶</a></h1><p>Next, we check the service status and make sure metrics are exported on the browser.</p><ol><li><p>Nginx service status <a href=http://localhost:8082/>http://localhost:8082/</a></p></li><li><p>Check Nginx exported metrics <a href=http://localhost:8082/stub_status>http://localhost:8082/stub_status</a>
<img loading=lazy src=https://i.imgur.com/WKbUrfu.png alt>
Nginx ç‹€æ…‹è³‡è¨Š * Active connections: 2
ç›®å‰æœ‰ 2 å€‹æ´»å‹•é€£ç·šã€‚</p><pre><code> * server accepts handled requests: 2 2 2
  - **2**ï¼šå·²æ¥å—çš„é€£ç·šæ•¸ã€‚Â 
  - **2**ï¼šå·²æˆåŠŸè™•ç†çš„é€£ç·šæ•¸ã€‚Â 
  - **2**ï¼šç¸½è«‹æ±‚æ•¸ï¼ˆå¯èƒ½å¤§æ–¼é€£ç·šæ•¸ï¼Œå› ç‚ºæ¯å€‹é€£ç·šå¯ä»¥è™•ç†å¤šå€‹è«‹æ±‚ï¼‰ã€‚Â 

 * Reading: 0 Writing: 1 Waiting: 1
  - Reading: 0ï¼šæ­£åœ¨è®€å–è«‹æ±‚çš„é€£ç·šæ•¸ã€‚Â 
  - Writing: 1ï¼šæ­£åœ¨å‚³é€éŸ¿æ‡‰çš„é€£ç·šæ•¸ã€‚Â 
  - Waiting: 1ï¼šç©ºé–’ç­‰å¾…æ–°è«‹æ±‚çš„é€£ç·šæ•¸ï¼ˆä½¿ç”¨ HTTP Keep-Aliveï¼‰ã€‚
      P.S.ç•¶å‰ä¼ºæœå™¨è² è¼‰è¼ƒè¼•ï¼Œå…±æœ‰ 2 å€‹é€£ç·šï¼Œå…¶ä¸­ 1 å€‹æ­£åœ¨è™•ç†è«‹æ±‚ï¼Œ1 å€‹è™•æ–¼ç­‰å¾…æ–°è«‹æ±‚çš„ç‹€æ…‹ã€‚
</code></pre></li><li><p>Check metrics collected by nginx-prometheus-exporter <a href=http://localhost:9113/metrics>http://localhost:9113/metrics</a>
<img loading=lazy src=https://i.imgur.com/t4wzqGo.png alt></p></li><li><p>Check host metrics collected by node exporter <a href=http://localhost:9100/metrics>http://localhost:9100/metrics</a>
<img loading=lazy src=https://i.imgur.com/c0BlkdM.png alt></p></li><li><p>Check endpoint status at Prometheus
Click <a href=http://localhost:9090/>http://localhost:9090/</a> to check if Prometheus is up and running.
We can type <strong>up</strong> to query the current alive endpoints .</p></li></ol><p><img loading=lazy src=https://i.imgur.com/SGeiSt2.png alt></p><p>We can type <strong>target</strong> to query the current alive endpoints .
<a href=http://localhost:9090/targets>http://localhost:9090/targets</a>
<img loading=lazy src=https://i.imgur.com/ex7oLXD.png alt></p><p>Now, the metrics are collect and redirected by Prometheus.</p><h1 id=visualization-output>Visualization output<a hidden class=anchor aria-hidden=true href=#visualization-output>Â¶</a></h1><p>Next, we use Grafana to create visual data.
Go to <a href=http://localhost:3000/>http://localhost:3000/</a>
<img loading=lazy src=https://i.imgur.com/UNLL3wI.png alt></p><p>Select <strong>Data Source</strong>
<img loading=lazy src=https://i.imgur.com/5zYyB0d.png alt></p><p>Click <strong>Test</strong> to test the connectivity between Prometheus and Grafana.
<img loading=lazy src=https://i.imgur.com/YfTSUOS.png alt></p><p>Then, we go to <strong>Dashboards</strong> and select <strong>New</strong> -> <strong>New dashboard</strong>.
We see the following page and select <strong>import dashboard</strong> to create new dashboard<br><img loading=lazy src=https://i.imgur.com/D1F3TQg.png alt></p><p><a href=https://grafana.com/grafana/dashboards/>å®˜ç¶²</a>ä¸Šä¹Ÿæœ‰å¾ˆå¤šdashboard template. é€™é‚Šæˆ‘ä½¿ç”¨ <a href=https://grafana.com/grafana/dashboards/1860-node-exporter-full/>Node exporter</a> ID 1860 è·Ÿ<a href=https://grafana.com/grafana/dashboards/14900-nginx/>Nginx exporter</a> ID 14900.</p><p>Dashboards</p><ul><li>for nginx:Â <a href=https://grafana.com/grafana/dashboards/12708>https://grafana.com/grafana/dashboards/12708</a></li><li>for node exporter :Â <a href=https://grafana.com/grafana/dashboards/1860>https://grafana.com/grafana/dashboards/1860</a></li></ul><p>We select <strong>load</strong>
<img loading=lazy src=https://i.imgur.com/K35T2YB.png alt></p><p>Also, select <strong>Prometheus data source</strong> and click <strong>import</strong>
<img loading=lazy src=https://i.imgur.com/fZJ3sEs.png alt></p><p>Once the dashboard is created, we can see the list of dashboards.
<img loading=lazy src=https://i.imgur.com/O6cIwZU.png alt></p><h3 id=dashboard-for-host>Dashboard for Host<a hidden class=anchor aria-hidden=true href=#dashboard-for-host>Â¶</a></h3><p><img loading=lazy src=https://i.imgur.com/wduXcIe.png alt></p><h3 id=dashboard-for-nginx>Dashboard for Nginx<a hidden class=anchor aria-hidden=true href=#dashboard-for-nginx>Â¶</a></h3><p><img loading=lazy src=https://i.imgur.com/HII6wLv.png alt></p><p>Now, we have visualized data for monitor.</p><p>To generate traffic, we can use <a href=https://www.markkulab.net/prometheus-monitoring-nginx-requests/>k6_script</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat k6_script.js<span class=p>|</span> docker run --rm -i grafana/k6 run -
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://i.imgur.com/FvH1iaE.png alt></p><p><img loading=lazy src=https://i.imgur.com/xh7ktos.png alt></p><h1 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>Â¶</a></h1><p>In this article, we demonstrate</p><ol><li>Using Prometheus to collect and monitor our host machine and Nginx service.</li><li>The collected metric information is further visualized in Grafana</li></ol><h1 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>Â¶</a></h1><p><a href=https://last9.hashnode.dev/how-to-download-and-run-node-exporter-using-docker#heading-step-2-run-the-node-exporter-container>https://last9.hashnode.dev/how-to-download-and-run-node-exporter-using-docker#heading-step-2-run-the-node-exporter-container</a></p><p><a href=https://github.com/880831ian/Prometheus-Grafana-Docker>https://github.com/880831ian/Prometheus-Grafana-Docker</a></p><p><a href=https://mxulises.medium.com/simple-prometheus-setup-on-docker-compose-f702d5f98579>https://mxulises.medium.com/simple-prometheus-setup-on-docker-compose-f702d5f98579</a></p><p><a href=https://github.com/880831ian/Prometheus-Grafana-Docker/tree/master>https://github.com/880831ian/Prometheus-Grafana-Docker/tree/master</a></p></div><footer class=post-footer><nav class=paginav><a class=prev href=https://nikeasyanzi.github.io/posts/container-monitoring-with-cadvisor/><span class=title><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left" style="user-select:text"><line x1="19" y1="12" x2="5" y2="12" style="user-select:text"/><polyline points="12 19 5 12 12 5" style="user-select:text"/></svg>&nbsp;Prev Page</span><br><span>Container Monitoring With cAdvisor</span>
</a><a class=next href=https://nikeasyanzi.github.io/posts/self-hosting-n8n-with-docker/><span class=title>Next Page&nbsp;<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Self hosting local n8n service</span></a></nav></footer><div class=comments-separator></div><div class=comments-box><div id=disqus_thread></div></div><script type=text/javascript>var disqus_config=function(){this.page.url="https://nikeasyanzi.github.io/posts/visualized-monitoring-with-prometheus-grafana/",this.page.identifier="visualized-monitoring-with-prometheus-grafana"};(function(){const t=window.DISQUS;if(t)t.reset({reload:!0,config:disqus_config});else{var n=document,e=n.createElement("script");e.src="//nikeasyanzi.disqus.com/embed.js",e.defer=!0,e.setAttribute("data-timestamp",+new Date),e.setAttribute("data-no-instant",""),n.head.appendChild(e)}})()</script></article></main><footer class=footer><span>&copy; 2025 <a href=https://nikeasyanzi.github.io/>Craig Yang's Dev Blog</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA</a>
</span><span style=display:inline-block;margin-left:1em>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/reorx/hugo-PaperModX/ rel=noopener target=_blank>PaperModX</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a="1"=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>